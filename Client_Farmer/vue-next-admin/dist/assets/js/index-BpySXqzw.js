import{a as Q}from"./order-B4pg5CEJ.js";import{b as W,S as X}from"./index-uJp-ZfSa.js";import{I as P}from"./index-B2JtjZyr.js";import{l as B,r as b,M as U,p as Y,w as Z,A as i,a5 as ee,O as S,C as h,P as m,H as e,F as te,D as a,S as s,B as ae,T as u,G as N,e as y}from"./.store-DdqHRk86.js";import{_ as le}from"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"system-land-order-container layout-padding"},oe={class:"system-land-order-padding layout-padding-auto layout-padding-view"},se={class:"system-land-order-search mb15"},ne={class:"price-amount"},de={class:"price-unit"},ie={class:"system-land-order-pagination mt15"},ue={key:0,class:"order-detail"},ce={key:0,class:"mt15"},pe={class:"image-gallery"},_e=B({name:"systemRole"}),me=B({..._e,setup(fe){const F=W(),I=b(!1),v=b(!1),n=b(null),d=U({orderId:"",userId:"",orderStatus:""}),c=U({currentPage:1,pageSize:20,total:0}),x=b([]),T=Y(()=>{let l=x.value;d.orderId&&(l=l.filter(o=>o.land_order_id.toString().includes(d.orderId))),d.userId&&(l=l.filter(o=>o.user_id.toString().includes(d.userId))),d.orderStatus&&(l=l.filter(o=>o.order_status===d.orderStatus)),c.total=l.length;const t=(c.currentPage-1)*c.pageSize,f=t+c.pageSize;return l.slice(t,f)}),z=async()=>{try{I.value=!0;let l=null;const t=X.get("farmInfo");if(t&&(t.farm_id||t.FarmID))l=t.farm_id||t.FarmID;else{const g=F.getUserInfo;g&&g.farm_id&&(l=g.farm_id)}if(!l){y.error("未找到农场信息，请先绑定农场");return}const f={farm_id:Number(l)},o=await Q(f);o.code===200||o.Code===200?(x.value=o.land_order||o.Land_order||[],y.success("土地订单加载成功")):y.error(o.msg||o.Msg||"获取土地订单失败")}catch(l){console.error("获取土地订单失败:",l),y.error("获取土地订单失败")}finally{I.value=!1}},C=l=>{if(!l)return"";try{return new Date(l).toLocaleString("zh-CN")}catch{return l}},D=l=>{switch(l){case"待付款":return"warning";case"待确认":return"info";case"租赁中":return"primary";case"已完成":return"success";case"已取消":return"danger";default:return"info"}},L=()=>{c.currentPage=1},M=()=>{d.orderId="",d.userId="",d.orderStatus="",c.currentPage=1,z()},O=l=>{n.value=l,v.value=!0},R=l=>{c.pageSize=l,c.currentPage=1},E=l=>{c.currentPage=l};return Z(()=>{z()}),(l,t)=>{const f=i("el-input"),o=i("el-option"),g=i("el-select"),$=i("ele-Search"),V=i("el-icon"),w=i("el-button"),j=i("ele-Refresh"),_=i("el-table-column"),A=i("el-link"),k=i("el-tag"),G=i("el-table"),H=i("el-pagination"),p=i("el-descriptions-item"),q=i("el-descriptions"),J=i("el-dialog"),K=ee("loading");return h(),S("div",re,[m("div",oe,[m("div",se,[e(f,{modelValue:d.orderId,"onUpdate:modelValue":t[0]||(t[0]=r=>d.orderId=r),size:"default",placeholder:"请输入订单ID",style:{"max-width":"160px"},clearable:""},{prepend:a(()=>[...t[7]||(t[7]=[s("订单ID",-1)])]),_:1},8,["modelValue"]),e(f,{modelValue:d.userId,"onUpdate:modelValue":t[1]||(t[1]=r=>d.userId=r),size:"default",placeholder:"请输入用户ID",style:{"max-width":"160px"},class:"ml10",clearable:""},{prepend:a(()=>[...t[8]||(t[8]=[s("用户ID",-1)])]),_:1},8,["modelValue"]),e(g,{modelValue:d.orderStatus,"onUpdate:modelValue":t[2]||(t[2]=r=>d.orderStatus=r),placeholder:"订单状态",style:{"max-width":"150px"},class:"ml10",clearable:""},{default:a(()=>[e(o,{label:"全部",value:""}),e(o,{label:"待付款",value:"待付款"}),e(o,{label:"待确认",value:"待确认"}),e(o,{label:"租赁中",value:"租赁中"}),e(o,{label:"已完成",value:"已完成"}),e(o,{label:"已取消",value:"已取消"})]),_:1},8,["modelValue"]),e(w,{size:"default",type:"primary",class:"ml10",onClick:L},{default:a(()=>[e(V,null,{default:a(()=>[e($)]),_:1}),t[9]||(t[9]=s(" 查询 ",-1))]),_:1}),e(w,{size:"default",type:"success",class:"ml10",onClick:M},{default:a(()=>[e(V,null,{default:a(()=>[e(j)]),_:1}),t[10]||(t[10]=s(" 刷新 ",-1))]),_:1})]),te((h(),ae(G,{data:T.value,style:{width:"100%"},border:"",stripe:""},{default:a(()=>[e(_,{type:"index",label:"序号",width:"60",align:"center"}),e(_,{prop:"land_order_id",label:"订单ID",width:"120",align:"center"},{default:a(r=>[e(A,{type:"primary"},{default:a(()=>[s(u(r.row.land_order_id),1)]),_:2},1024)]),_:1}),e(_,{label:"土地图片",width:"100",align:"center"},{default:a(r=>[e(P,{images:r.row.image_urls,width:"50px",height:"50px","show-controls":!0,"show-indicators":!1,"show-thumbnails":!1,"show-preview":!0,"border-radius":"4px"},null,8,["images"])]),_:1}),e(_,{prop:"detail",label:"订单详情","min-width":"150","show-overflow-tooltip":""}),e(_,{label:"租赁信息",width:"120",align:"center"},{default:a(r=>[m("div",null,[m("div",ne,"¥"+u(r.row.price),1),m("div",de,u(r.row.count)+"天",1)])]),_:1}),e(_,{prop:"farm_address",label:"农场地址","min-width":"150","show-overflow-tooltip":""}),e(_,{prop:"order_status",label:"订单状态",width:"100",align:"center"},{default:a(r=>[e(k,{type:D(r.row.order_status),size:"small"},{default:a(()=>[s(u(r.row.order_status),1)]),_:2},1032,["type"])]),_:1}),e(_,{prop:"create_time",label:"创建时间",width:"160",align:"center"},{default:a(r=>[s(u(C(r.row.create_time)),1)]),_:1}),e(_,{label:"操作",width:"120",align:"center",fixed:"right"},{default:a(r=>[e(w,{size:"small",type:"primary",link:"",onClick:ge=>O(r.row)},{default:a(()=>[...t[11]||(t[11]=[s(" 详情 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[K,I.value]]),m("div",ie,[e(H,{"current-page":c.currentPage,"onUpdate:currentPage":t[3]||(t[3]=r=>c.currentPage=r),"page-size":c.pageSize,"onUpdate:pageSize":t[4]||(t[4]=r=>c.pageSize=r),"page-sizes":[10,20,50,100],total:c.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:R,onCurrentChange:E},null,8,["current-page","page-size","total"])])]),e(J,{modelValue:v.value,"onUpdate:modelValue":t[6]||(t[6]=r=>v.value=r),title:"土地订单详情",width:"600px","close-on-click-modal":!1},{footer:a(()=>[e(w,{onClick:t[5]||(t[5]=r=>v.value=!1)},{default:a(()=>[...t[13]||(t[13]=[s("关闭",-1)])]),_:1})]),default:a(()=>[n.value?(h(),S("div",ue,[e(q,{column:2,border:""},{default:a(()=>[e(p,{label:"订单ID"},{default:a(()=>[s(u(n.value.land_order_id),1)]),_:1}),e(p,{label:"订单状态"},{default:a(()=>[e(k,{type:D(n.value.order_status)},{default:a(()=>[s(u(n.value.order_status),1)]),_:1},8,["type"])]),_:1}),e(p,{label:"土地ID"},{default:a(()=>[s(u(n.value.land_id),1)]),_:1}),e(p,{label:"农场ID"},{default:a(()=>[s(u(n.value.farm_id),1)]),_:1}),e(p,{label:"用户ID"},{default:a(()=>[s(u(n.value.user_id),1)]),_:1}),e(p,{label:"租赁价格"},{default:a(()=>[s("¥"+u(n.value.price),1)]),_:1}),e(p,{label:"租赁时长"},{default:a(()=>[s(u(n.value.count)+"天",1)]),_:1}),e(p,{label:"创建时间"},{default:a(()=>[s(u(C(n.value.create_time)),1)]),_:1}),e(p,{label:"农场地址",span:2},{default:a(()=>[s(u(n.value.farm_address),1)]),_:1}),e(p,{label:"订单详情",span:2},{default:a(()=>[s(u(n.value.detail),1)]),_:1})]),_:1}),n.value.image_urls?(h(),S("div",ce,[t[12]||(t[12]=m("h4",null,"土地图片",-1)),m("div",pe,[e(P,{images:n.value.image_urls,width:"200px",height:"150px","show-controls":!0,"show-indicators":!0,"show-thumbnails":!0,"show-preview":!0,"border-radius":"8px"},null,8,["images"])])])):N("",!0)])):N("",!0)]),_:1},8,["modelValue"])])}}}),Ie=le(me,[["__scopeId","data-v-df160559"]]);export{Ie as default};
