import{g as W}from"./order-DRMI4uPo.js";import{b as X,S as Y}from"./index-Bt6IFO1h.js";import{I as P}from"./index-nj3ubUuu.js";import{l as B,r as b,M as U,p as Z,w as ee,A as i,a5 as te,O as S,C as h,H as e,D as l,P as m,F as le,S as r,B as ae,T as n,G as N,e as I}from"./.store-D3f7YvtR.js";import{_ as oe}from"./_plugin-vue_export-helper-DlAUqK2U.js";const re={class:"system-order-container layout-pd"},se={class:"system-order-search mb15"},ne={class:"price-amount"},de={class:"price-unit"},ie={class:"system-order-pagination mt15"},ue={key:0,class:"order-detail"},ce={key:0,class:"mt15"},_e={class:"image-gallery"},pe=B({name:"systemMenu"}),me=B({...pe,setup(fe){const F=X(),y=b(!1),v=b(!1),d=b(null),u=U({orderId:"",userId:"",orderStatus:""}),c=U({currentPage:1,pageSize:20,total:0}),x=b([]),M=Z(()=>{let a=x.value;u.orderId&&(a=a.filter(s=>s.good_order_id.toString().includes(u.orderId))),u.userId&&(a=a.filter(s=>s.user_id.toString().includes(u.userId))),u.orderStatus&&(a=a.filter(s=>s.order_status===u.orderStatus)),c.total=a.length;const t=(c.currentPage-1)*c.pageSize,f=t+c.pageSize;return a.slice(t,f)}),z=async()=>{try{y.value=!0;let a=null;const t=Y.get("farmInfo");if(t&&(t.farm_id||t.FarmID))a=t.farm_id||t.FarmID;else{const g=F.getUserInfo;g&&g.farm_id&&(a=g.farm_id)}if(!a){I.error("未找到农场信息，请先绑定农场");return}const f={farm_id:Number(a)},s=await W(f);s.code===200||s.Code===200?(x.value=s.good_order||s.Good_order||[],I.success("农产品订单加载成功")):I.error(s.msg||s.Msg||"获取农产品订单失败")}catch(a){console.error("获取农产品订单失败:",a),I.error("获取农产品订单失败")}finally{y.value=!1}},C=a=>{if(!a)return"";try{return new Date(a).toLocaleString("zh-CN")}catch{return a}},D=a=>{switch(a){case"待付款":return"warning";case"待发货":return"info";case"已发货":return"primary";case"已完成":return"success";case"已取消":return"danger";default:return"info"}},T=()=>{c.currentPage=1},G=()=>{u.orderId="",u.userId="",u.orderStatus="",c.currentPage=1,z()},O=a=>{d.value=a,v.value=!0},R=a=>{c.pageSize=a,c.currentPage=1},E=a=>{c.currentPage=a};return ee(()=>{z()}),(a,t)=>{const f=i("el-input"),s=i("el-option"),g=i("el-select"),$=i("ele-Search"),V=i("el-icon"),w=i("el-button"),j=i("ele-Refresh"),p=i("el-table-column"),A=i("el-link"),k=i("el-tag"),H=i("el-table"),L=i("el-pagination"),q=i("el-card"),_=i("el-descriptions-item"),J=i("el-descriptions"),K=i("el-dialog"),Q=te("loading");return h(),S("div",re,[e(q,{shadow:"hover"},{default:l(()=>[m("div",se,[e(f,{modelValue:u.orderId,"onUpdate:modelValue":t[0]||(t[0]=o=>u.orderId=o),size:"default",placeholder:"请输入订单ID",style:{"max-width":"160px"},clearable:""},{prepend:l(()=>[...t[7]||(t[7]=[r("订单ID",-1)])]),_:1},8,["modelValue"]),e(f,{modelValue:u.userId,"onUpdate:modelValue":t[1]||(t[1]=o=>u.userId=o),size:"default",placeholder:"请输入用户ID",style:{"max-width":"160px"},class:"ml10",clearable:""},{prepend:l(()=>[...t[8]||(t[8]=[r("用户ID",-1)])]),_:1},8,["modelValue"]),e(g,{modelValue:u.orderStatus,"onUpdate:modelValue":t[2]||(t[2]=o=>u.orderStatus=o),placeholder:"订单状态",style:{"max-width":"150px"},class:"ml10",clearable:""},{default:l(()=>[e(s,{label:"全部",value:""}),e(s,{label:"待付款",value:"待付款"}),e(s,{label:"待发货",value:"待发货"}),e(s,{label:"已发货",value:"已发货"}),e(s,{label:"已完成",value:"已完成"}),e(s,{label:"已取消",value:"已取消"})]),_:1},8,["modelValue"]),e(w,{size:"default",type:"primary",class:"ml10",onClick:T},{default:l(()=>[e(V,null,{default:l(()=>[e($)]),_:1}),t[9]||(t[9]=r(" 查询 ",-1))]),_:1}),e(w,{size:"default",type:"success",class:"ml10",onClick:G},{default:l(()=>[e(V,null,{default:l(()=>[e(j)]),_:1}),t[10]||(t[10]=r(" 刷新 ",-1))]),_:1})]),le((h(),ae(H,{data:M.value,style:{width:"100%"},border:"",stripe:""},{default:l(()=>[e(p,{type:"index",label:"序号",width:"60",align:"center"}),e(p,{prop:"good_order_id",label:"订单ID",width:"120",align:"center"},{default:l(o=>[e(A,{type:"primary"},{default:l(()=>[r(n(o.row.good_order_id),1)]),_:2},1024)]),_:1}),e(p,{label:"商品图片",width:"100",align:"center"},{default:l(o=>[e(P,{images:o.row.image_urls,width:"50px",height:"50px","show-controls":!0,"show-indicators":!1,"show-thumbnails":!1,"show-preview":!0,"border-radius":"4px"},null,8,["images"])]),_:1}),e(p,{prop:"detail",label:"订单详情","min-width":"150","show-overflow-tooltip":""}),e(p,{label:"价格信息",width:"120",align:"center"},{default:l(o=>[m("div",null,[m("div",ne,"¥"+n(o.row.price),1),m("div",de,n(o.row.count)+n(o.row.units),1)])]),_:1}),e(p,{prop:"user_address",label:"用户地址","min-width":"120","show-overflow-tooltip":""}),e(p,{prop:"farm_address",label:"农场地址","min-width":"120","show-overflow-tooltip":""}),e(p,{prop:"order_status",label:"订单状态",width:"100",align:"center"},{default:l(o=>[e(k,{type:D(o.row.order_status),size:"small"},{default:l(()=>[r(n(o.row.order_status),1)]),_:2},1032,["type"])]),_:1}),e(p,{prop:"create_time",label:"创建时间",width:"160",align:"center"},{default:l(o=>[r(n(C(o.row.create_time)),1)]),_:1}),e(p,{label:"操作",width:"120",align:"center",fixed:"right"},{default:l(o=>[e(w,{size:"small",type:"primary",link:"",onClick:ge=>O(o.row)},{default:l(()=>[...t[11]||(t[11]=[r(" 详情 ",-1)])]),_:2},1032,["onClick"])]),_:1})]),_:1},8,["data"])),[[Q,y.value]]),m("div",ie,[e(L,{"current-page":c.currentPage,"onUpdate:currentPage":t[3]||(t[3]=o=>c.currentPage=o),"page-size":c.pageSize,"onUpdate:pageSize":t[4]||(t[4]=o=>c.pageSize=o),"page-sizes":[10,20,50,100],total:c.total,layout:"total, sizes, prev, pager, next, jumper",onSizeChange:R,onCurrentChange:E},null,8,["current-page","page-size","total"])])]),_:1}),e(K,{modelValue:v.value,"onUpdate:modelValue":t[6]||(t[6]=o=>v.value=o),title:"订单详情",width:"600px","close-on-click-modal":!1},{footer:l(()=>[e(w,{onClick:t[5]||(t[5]=o=>v.value=!1)},{default:l(()=>[...t[13]||(t[13]=[r("关闭",-1)])]),_:1})]),default:l(()=>[d.value?(h(),S("div",ue,[e(J,{column:2,border:""},{default:l(()=>[e(_,{label:"订单ID"},{default:l(()=>[r(n(d.value.good_order_id),1)]),_:1}),e(_,{label:"订单状态"},{default:l(()=>[e(k,{type:D(d.value.order_status)},{default:l(()=>[r(n(d.value.order_status),1)]),_:1},8,["type"])]),_:1}),e(_,{label:"商品ID"},{default:l(()=>[r(n(d.value.good_id),1)]),_:1}),e(_,{label:"农场ID"},{default:l(()=>[r(n(d.value.farm_id),1)]),_:1}),e(_,{label:"用户ID"},{default:l(()=>[r(n(d.value.user_id),1)]),_:1}),e(_,{label:"价格"},{default:l(()=>[r("¥"+n(d.value.price),1)]),_:1}),e(_,{label:"数量"},{default:l(()=>[r(n(d.value.count)+n(d.value.units),1)]),_:1}),e(_,{label:"创建时间"},{default:l(()=>[r(n(C(d.value.create_time)),1)]),_:1}),e(_,{label:"用户地址",span:2},{default:l(()=>[r(n(d.value.user_address),1)]),_:1}),e(_,{label:"农场地址",span:2},{default:l(()=>[r(n(d.value.farm_address),1)]),_:1}),e(_,{label:"订单详情",span:2},{default:l(()=>[r(n(d.value.detail),1)]),_:1})]),_:1}),d.value.image_urls?(h(),S("div",ce,[t[12]||(t[12]=m("h4",null,"商品图片",-1)),m("div",_e,[e(P,{images:d.value.image_urls,width:"200px",height:"150px","show-controls":!0,"show-indicators":!0,"show-thumbnails":!0,"show-preview":!0,"border-radius":"8px"},null,8,["images"])])])):N("",!0)])):N("",!0)]),_:1},8,["modelValue"])])}}}),ye=oe(me,[["__scopeId","data-v-654af445"]]);export{ye as default};
