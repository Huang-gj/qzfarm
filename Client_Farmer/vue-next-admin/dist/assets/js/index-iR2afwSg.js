import{l as $,r as ee,s as te,M as ae,p as x,A as i,a5 as oe,O as b,C as r,F as le,P as k,B as u,D as c,G as S,$ as v,a0 as V,X as ne,S as T,T as se,H as l,ak as ie,ag as re,e as ce,ar as de,n as pe,as as ge}from"./.store-CUxRj2E2.js";import{u as me}from"./index-ehGYOv3s.js";import{_ as he}from"./_plugin-vue_export-helper-DlAUqK2U.js";const ue={class:"table-container"},fe={class:"table-footer mt15"},be={class:"table-footer-tool"},ke={class:"tool-box"},ye=["data-key"],_e=$({name:"netxTable"}),Ce=$({..._e,props:{data:{type:Array,default:()=>[]},header:{type:Array,default:()=>[]},config:{type:Object,default:()=>{}},printName:{type:String,default:()=>""}},emits:["delRow","pageChange","sortHeader"],setup(p,{expose:N,emit:L}){const n=p,h=L,z=ee(),A=me(),{themeConfig:E}=te(A),o=ae({page:{pageNum:1,pageSize:10},selectlist:[],checkListAll:!0,checkListIndeterminate:!1}),I=x(()=>!!n.config.isBorder),y=x(()=>n.config),R=x(()=>n.header.filter(a=>a.isCheck)),B=a=>{a?n.header.forEach(t=>t.isCheck=!0):n.header.forEach(t=>t.isCheck=!1),o.checkListIndeterminate=!1},U=()=>{const a=n.header.filter(t=>t.isCheck).length;o.checkListAll=a===n.header.length,o.checkListIndeterminate=a>0&&a<n.header.length},D=a=>{o.selectlist=a},H=a=>{h("delRow",a)},j=a=>{o.page.pageSize=a,h("pageChange",o.page)},P=a=>{o.page.pageNum=a,h("pageChange",o.page)},O=()=>{o.page.pageNum=1,o.page.pageSize=10,h("pageChange",o.page)},q=()=>{let a="",t="",s={};n.header.forEach(d=>{a+=`<th class="table-th">${d.title}</th>`}),n.data.forEach((d,m)=>{s[m]||(s[m]=[]),n.header.forEach(g=>{g.type==="text"?s[m].push(`<td class="table-th table-center">${d[g.key]}</td>`):g.type==="image"&&s[m].push(`<td class="table-th table-center"><img src="${d[g.key]}" style="width:${g.width}px;height:${g.height}px;"/></td>`)}),t+=`<tr>${s[m].join("")}</tr>`}),re({printable:`<div style=display:flex;flex-direction:column;text-align:center><h3>${n.printName}</h3></div><table border=1 cellspacing=0><tr>${a}${t}</table>`,type:"raw-html",css:["//at.alicdn.com/t/c/font_2298093_rnp72ifj3ba.css","//unpkg.com/element-plus/dist/index.css"],style:"@media print{.mb15{margin-bottom:15px;}.el-button--small i.iconfont{font-size: 12px !important;margin-right: 5px;}}; .table-th{word-break: break-all;white-space: pre-wrap;}.table-center{text-align: center;}"})},F=()=>{if(o.selectlist.length<=0)return ce.warning("请先选择要导出的数据");de(n.header,o.selectlist,`${E.value.globalTitle} ${new Date().toLocaleString()}`)},M=()=>{h("pageChange",o.page)},G=()=>{pe(()=>{const a=ge.create(z.value,{handle:".handle",dataIdAttr:"data-key",animation:150,onEnd:()=>{const t=[];a.toArray().forEach(s=>{n.header.forEach(d=>{d.key===s&&t.push({...d})})}),h("sortHeader",t)}})})};return N({pageReset:O}),(a,t)=>{const s=i("el-table-column"),d=i("el-image"),m=i("el-button"),g=i("el-popconfirm"),J=i("el-empty"),W=i("el-table"),X=i("el-pagination"),f=i("SvgIcon"),K=i("el-tooltip"),_=i("el-checkbox"),Q=i("el-scrollbar"),Y=i("el-popover"),Z=oe("loading");return r(),b("div",ue,[le((r(),u(W,ie({data:p.data,border:I.value},a.$attrs,{"row-key":"id",stripe:"",style:{width:"100%"},onSelectionChange:D}),{empty:c(()=>[l(J,{description:"暂无数据"})]),default:c(()=>[p.config.isSelection?(r(),u(s,{key:0,type:"selection","reserve-selection":!0,width:"30"})):S("",!0),p.config.isSerialNo?(r(),u(s,{key:1,type:"index",label:"序号",width:"60"})):S("",!0),(r(!0),b(v,null,V(R.value,(e,C)=>(r(),u(s,{key:C,"show-overflow-tooltip":"",prop:e.key,width:e.colWidth,label:e.title},{default:c(w=>[e.type==="image"?(r(),u(d,{key:0,style:ne({width:`${e.width}px`,height:`${e.height}px`}),src:w.row[e.key],"zoom-rate":1.2,"preview-src-list":[w.row[e.key]],"preview-teleported":"",fit:"cover"},null,8,["style","src","preview-src-list"])):(r(),b(v,{key:1},[T(se(w.row[e.key]),1)],64))]),_:2},1032,["prop","width","label"]))),128)),p.config.isOperate?(r(),u(s,{key:2,label:"操作",width:"100"},{default:c(e=>[l(g,{title:"确定删除吗？",onConfirm:C=>H(e.row)},{reference:c(()=>[l(m,{text:"",type:"primary"},{default:c(()=>[...t[5]||(t[5]=[T("删除",-1)])]),_:1})]),_:2},1032,["onConfirm"])]),_:1})):S("",!0)]),_:1},16,["data","border"])),[[Z,p.config.loading]]),k("div",fe,[l(X,{"current-page":o.page.pageNum,"onUpdate:currentPage":t[0]||(t[0]=e=>o.page.pageNum=e),"page-size":o.page.pageSize,"onUpdate:pageSize":t[1]||(t[1]=e=>o.page.pageSize=e),"pager-count":5,"page-sizes":[10,20,30],total:p.config.total,layout:"total, sizes, prev, pager, next, jumper",background:"",onSizeChange:j,onCurrentChange:P},null,8,["current-page","page-size","total"]),k("div",be,[l(f,{name:"iconfont icon-dayin",size:19,title:"打印",onClick:q}),l(f,{name:"iconfont icon-yunxiazai_o",size:22,title:"导出",onClick:F}),l(f,{name:"iconfont icon-shuaxin",size:22,title:"刷新",onClick:M}),l(Y,{placement:"top-end",trigger:"click",transition:"el-zoom-in-top","popper-class":"table-tool-popper",width:300,persistent:!1,onShow:G},{reference:c(()=>[l(f,{name:"iconfont icon-quanjushezhi_o",size:22,title:"设置"})]),default:c(()=>[k("div",ke,[l(K,{content:"拖动进行排序",placement:"top-start"},{default:c(()=>[l(f,{name:"fa fa-question-circle-o",size:17,class:"ml11",color:"#909399"})]),_:1}),l(_,{modelValue:o.checkListAll,"onUpdate:modelValue":t[2]||(t[2]=e=>o.checkListAll=e),indeterminate:o.checkListIndeterminate,class:"ml10 mr1",label:"列显示",onChange:B},null,8,["modelValue","indeterminate"]),l(_,{modelValue:y.value.isSerialNo,"onUpdate:modelValue":t[3]||(t[3]=e=>y.value.isSerialNo=e),class:"ml12 mr1",label:"序号"},null,8,["modelValue"]),l(_,{modelValue:y.value.isSelection,"onUpdate:modelValue":t[4]||(t[4]=e=>y.value.isSelection=e),class:"ml12 mr1",label:"多选"},null,8,["modelValue"])]),l(Q,null,{default:c(()=>[k("div",{ref_key:"toolSetRef",ref:z,class:"tool-sortable"},[(r(!0),b(v,null,V(p.header,e=>(r(),b("div",{class:"tool-sortable-item",key:e.key,"data-key":e.key},[t[6]||(t[6]=k("i",{class:"fa fa-arrows-alt handle cursor-pointer"},null,-1)),l(_,{modelValue:e.isCheck,"onUpdate:modelValue":C=>e.isCheck=C,size:"default",class:"ml12 mr8",label:e.title,onChange:U},null,8,["modelValue","onUpdate:modelValue","label"])],8,ye))),128))],512)]),_:1})]),_:1})])])])}}}),ve=he(Ce,[["__scopeId","data-v-8ecc6b8a"]]);export{ve as default};
